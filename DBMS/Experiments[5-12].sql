CREATE TABLE EMPLOYEE (
    EMPLOYEE_NAME VARCHAR(15) NOT NULL,
    STEET VARCHAR(15) NOT NULL,
    CITY VARCHAR(15) NOT NULL,
    PRIMARY KEY(EMPLOYEE_NAME)
);

CREATE TABLE WORKS (
    EMPLOYEE_NAME VARCHAR(15) NOT NULL,
    COMPANY_NAME VARCHAR(15) NOT NULL,
    SALARY INT NOT NULL
);

CREATE TABLE COMPANY (
    COMPANY_NAME VARCHAR(15) NOT NULL,
    CITY VARCHAR(15) NOT NULL,
    PRIMARY KEY(COMPANY_NAME)
);

CREATE TABLE MANAGES (
    EMPLOYEE_NAME VARCHAR(15) NOT NULL,
    MANAGER_NAME VARCHAR(15) NOT NULL
);

INSERT INTO EMPLOYEE VALUES ('ASHISH','GT ROAD','MUMBAI');
INSERT INTO EMPLOYEE VALUES ('SURESH','CN ROAD','THANE');
INSERT INTO EMPLOYEE VALUES ('RAMESH','RU ROAD','ULHASNAGAR');
INSERT INTO EMPLOYEE VALUES ('MAHESH','RU ROAD','MUMBAI');
INSERT INTO EMPLOYEE VALUES ('RAKESH','RU ROAD','MUMBAI');

INSERT INTO WORKS VALUES ('ASHISH','GOOGLE',150000);
INSERT INTO WORKS VALUES ('SURESH','AMAZON',135000);
INSERT INTO WORKS VALUES ('RAMESH','CHINA',100000);
INSERT INTO WORKS VALUES ('MAHESH','GOOGLE',145000);
INSERT INTO WORKS VALUES ('RAKESH','GOOGLE',350000);

INSERT INTO COMPANY VALUES ('GOOGLE','MUMBAI');
INSERT INTO COMPANY VALUES ('AMAZON','THANE');
INSERT INTO COMPANY VALUES ('CHINA','ULHASNAGAR');
INSERT INTO COMPANY VALUES ('US','BHANDUP');
INSERT INTO COMPANY VALUES ('FRANCE','MULUND');

INSERT INTO MANAGES VALUES ('ASHISH','MGR1');
INSERT INTO MANAGES VALUES ('SURESH','MGR2');
INSERT INTO MANAGES VALUES ('RAMESH','MGR3');
INSERT INTO MANAGES VALUES ('MAHESH','MGR3');
INSERT INTO MANAGES VALUES ('RAKESH','MGR3');

ALTER TABLE WORKS ADD FOREIGN KEY(EMPLOYEE_NAME) REFERENCES EMPLOYEE(EMPLOYEE_NAME) ON DELETE CASCADE;
ALTER TABLE MANAGES ADD FOREIGN KEY(EMPLOYEE_NAME) REFERENCES EMPLOYEE(EMPLOYEE_NAME);

DELETE FROM WORKS WHERE EMPLOYEE_NAME='SURESH';
SELECT EMPLOYEE_NAME FROM WORKS WHERE COMPANY_NAME!='GOOGLE';
SELECT COMPANY_NAME, CNT
FROM (
    SELECT COMPANY_NAME, count(EMPLOYEE_NAME) AS CNT
    FROM WORKS
    GROUP BY COMPANY_NAME
) W1
ORDER BY cnt DESC
LIMIT 1

SELECT DNUMBER,FNAME,PNUMBER FROM DEPARTMENT, EMPLOYEE, WORKS_ON,PROJECT WHERE DNUMBER=DNO AND SSN = ESSN AND PNO = PNUMBER ORDER BY DNAME DESC, LNAME ASC, FNAME ASC;

SELECT FNAME,LNAME,DNAME FROM DEPARTMENT JOIN EMPLOYEE ON DNUMBER;

SELECT FNAME,LNAME,DNAME FROM DEPARTMENT LEFT OUTER JOIN EMPLOYEE ON DNUMBER= DNO;

SELECT FNAME,LNAME,DNAME FROM DEPARTMENT RIGHT OUTER JOIN EMPLOYEE ON DNUMBER= DNO;

SELECT FNAME,LNAME,DNAME FROM DEPARTMENT FULL OUTER JOIN EMPLOYEE ON DNUMBER= DNO;

SELECT FNAME, DNO FROM EMPLOYEE CROSS JOIN DEPARTMENT;

SELECT E.FNAME ,S.FNAME FROM EMPLOYEE E JOIN EMPLOYEE S ON E.SUPERSSN = S.SSN;

SELECT E.FNAME,E.LNAME, ADDRESS FROM (DEPARTMENT D (DNUM,DNO,MGRSSN),MGR_DATE) NATURAL JOIN EMPLOYEE (FNAME,MNAME,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPERSSN);

SELECT FNAME,MGR_START_DATE FROM EMPLOYEE E JOIN DEPARTMENT D ON EDNO = D DNUMBER;

--Q25
UPDATE EMPLOYEE SET CITY='AGRA' WHERE EMPLOYEE_NAME='ASHISH';
SELECT STEET ,CITY FROM EMPLOYEE WHERE (SELECT EMPLOYEE_NAME FROM WORKS WHERE COMPANY_NAME='GOOGLE' AND SALARY>135000);